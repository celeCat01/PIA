"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[53970],{975216:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var i=n(667294),a=n(545007),r=n(883119),o=n(587114),l=n(224796),s=n(510989),c=n(220488),d=n(619370),u=n(172203),_=n(140017),p=n(906623);function m({constraint:e}){let t=(0,p.E)(),n=t?.getId();return(0,i.useEffect)(()=>{t&&t.markConstraintComplete(e)},[n,e]),null}var v=n(608516),f=n(731714),h=n(623409),x=n(494125),E=n(855142),y=n(559510),g=n(325945),S=n(623281),I=n(728294),k=n(785893);let w=(0,I.Z)(()=>n.e(43473).then(n.bind(n,316503)),void 0,"PinSaveButtonCommon"),Z=(0,i.lazy)(async()=>({default:(await Promise.all([n.e(69965),n.e(22538)]).then(n.bind(n,758697))).QuickSaveButtonWithExperienceAnchor})),b=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:n,onBoardSelectionFlyoutChange:I,onClickCallback:b,pin:C,showEnabledSaveBehavior:A,showRepinOnInitialRender:R,variant:T,viewParameter:j,viewType:P})=>{let D=(0,p.E)(),{experience:U}=(0,u.Z)(1000310),{experience:L}=(0,u.Z)(12),M=(0,h.Z)(),N=(0,a.I0)(),B=(0,_.ZP)(),O=(0,i.useRef)(!1),{pins:K,clear:Q}=(0,y.Z)(),z=(0,f.M0)().getItem(l.M8)||"",H=z?z===C.id:!!K&&K.length>0&&K[K.length-1].id===C.id;(0,x.Z)(()=>{O.current||2!==K.length&&(1!==K.length||H)||(O.current=!0,(2===K.length&&!z&&H?[K[0]]:K).forEach(({id:e,nodeId:t})=>{(0,o.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},B).then(n=>{let{id:i,url:a,name:r}=n;N((0,g.d)({boardId:i,url:a,title:r||"",pinId:e||"",nodeId:t}))})}),H||Q())});let W=()=>{(0,f.M0)().removeItem(l.M8),(0,f.M0)().removeItem(l.RD),Q(),M({action:"trigger",item:"unauth-save-button-quicksave"}),N((0,S.hT)(!0)),N((0,g.d)({boardId:"",url:"",title:"Profile",pinId:C.id,nodeId:C?.node_id})),N((0,g.X)(C))},F=()=>{D&&D.markConstraintComplete("button")};if(C?.pinner?.blocked_by_me||C?.promoted_is_removable)return(0,k.jsx)(m,{constraint:"button"});if(U&&502450===U.experience_id)return(0,k.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,k.jsx)(v.Z,{children:(0,k.jsx)(Z,{autoQuicksaveCallback:W,clientTrackingParams:t,experience:U,onClickCallback:b,onMount:F,pinKey:{type:"deprecated",data:C},shouldAutoQuicksave:H,showEnabledSaveBehavior:A,viewParameter:j})})});let G=!C.content_sensitivity?.is_sensitive_content&&void 0!==e,$=[501041],V=L&&501041===L.experience_id&&L.display_data.has_tooltip?e=>(0,k.jsx)(d.default,{anchor:e,experienceIds:$,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,k.jsx)(c.Z,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return G?(0,k.jsx)(r.xu,{children:(0,k.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,k.jsx)(E.default,{autoQuicksaveCallback:W,clientTrackingParams:t,fromEggsBoard:n,onClickCallback:b,onMount:F,onToggleFlyout:I,pinKey:{type:"deprecated",data:C},renderPinSaveTooltip:V,shouldAutoQuicksave:H,variant:T,viewParameter:j,viewType:P})})}):(0,k.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,k.jsx)(v.Z,{children:(0,k.jsx)(w,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:b,onMount:F,pinKey:{type:"deprecated",data:C},renderPinSaveTooltip:V,showRepinOnInitialRender:R})})})}},220488:(e,t,n)=>{n.d(t,{Z:()=>m});var i=n(667294),a=n(883119),r=n(510989),o=n(401429),l=n(862249),s=n(983983),c=n(785893);let d=s.fe,u=new a.Ry(d-1);function _(e){let{button:t,onClick:n}=e;return t.url?(0,c.jsx)(a.ZP,{color:"white",fullWidth:!0,href:t.url,onClick:n,rel:(0,l.Z)({url:t.url})?"nofollow":"none",text:t.text}):(0,c.jsx)(a.zx,{color:"white",fullWidth:!0,onClick:n,text:t.text})}let p=e=>{let t;let{anchors:n,experience:r,dismiss:o,complete:l,scrollToDismiss:s,onAnchorTouch:d,idealDirection:p}=e,m=!0,{message:v,anchor:f,complete_button:h}=(r||{}).display_data,x=n[f],E=()=>{t&&clearTimeout(t),o()},y=()=>{t||m||(t=setTimeout(()=>E(),1500)),m=!1};return(0,i.useEffect)(()=>(x&&(s&&(window.addEventListener("scroll",y),window.addEventListener("touchmove",y)),d&&x&&x.addEventListener("click","complete"===d?l:E)),()=>{s&&(window.removeEventListener("scroll",y),window.removeEventListener("touchmove",y),t&&clearTimeout(t)),d&&x&&x.removeEventListener("click","complete"===d?l:E)}),[x]),(0,c.jsx)(a.Li,{anchor:x,idealDirection:p,onDismiss:E,zIndex:u,children:(0,c.jsx)(a.xu,{padding:4,tabIndex:0,children:(0,c.jsxs)(a.kC,{direction:"column",gap:3,children:[(0,c.jsx)(a.xv,{color:"light",children:v}),h&&(0,c.jsx)(_,{button:h,onClick:l})]})})})},m=e=>{let{placementId:t,anchors:n}=e,[a,l]=(0,i.useState)(!0),s=()=>l(!1);return(0,c.jsx)(r.Z,{name:"ExperiencePopoverEducational",children:a&&(0,c.jsx)(o.Z,{placementId:t,predicate:e=>{if(e?.type!==29)return!1;let{anchor:t}=(e||{}).display_data;return!!t&&!!n[t]},children:({complete:t,dismiss:n,experience:i})=>(0,c.jsx)(p,{...e,complete:()=>{s(),t()},dismiss:()=>{s(),n()},experience:i})})})}},235712:(e,t,n)=>{n.d(t,{i:()=>a,x:()=>r});var i=n(96452);let a=["shopping_rec_disabled","featureMap","comments_disabled","allow_mentions","messaging_permissions","opt_in_private_account","ads_customize_from_conversion","personalize_from_offsite_browsing","third_party_marketing_tracking_enabled","ccpa_opted_out","third_party_ads_personalization","video_rec_enabled"];function r({apiErrorCode:e,onShowMessage:t,onPassCodeRequired:n,onPassCodeSkipConfirmation:a}){e&&(({[i.RR]:t,[i.mX]:n,[i.q6]:a})[e]||t)()}},876605:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(216167);let a=e=>i.Z.create("UserPasswordResource",e).callUpdate({showError:!1})},175789:(e,t,n)=>{n.d(t,{Z:()=>i});let i=(e,t)=>e.length>t?e.substr(0,t-3).trim()+"â€¦":e},559510:(e,t,n)=>{n.d(t,{$:()=>c,Z:()=>_});var i=n(224796),a=n(127285),r=n(5859),o=n(944662),l=n(731714),s=n(233440);let c=2,d=e=>e?.pins??[],u=e=>e.length?{pins:e}:null,_=()=>{let{isAuthenticated:e,countryFromHostName:t,countryFromIp:n}=(0,r.B)(),_=(0,o.Z)({countryFromHostName:t||"",countryFromIp:n||"",isAuthenticated:e}),p=(0,l.M0)(),m=d(_?p.getItem(i.s1):s.ZP.getItem(a.w3)),v=e=>_?p.setItem(i.s1,u(e)):s.ZP.setItem(a.w3,u(e)),f=()=>m.length<c;return{pins:m,save:e=>{f()&&v(m.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>v(m.filter(({id:t})=>t!==e)),isSaved:e=>m.some(({id:t})=>t===e),clear:()=>v([]),canSaveMore:f}}},623281:(e,t,n)=>{n.d(t,{Cp:()=>v,GT:()=>c,V6:()=>l,W2:()=>u,W6:()=>f,_L:()=>m,fm:()=>s,hT:()=>d});var i=n(216167),a=n(235712),r=n(876605),o=n(227258);function l(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}let s=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),c=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function d(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}let u=(e,t,n)=>i=>{i({type:"USER_SETTING_CHANGE",payload:{id:e,field:t,value:n}})},_=(e,t,n)=>i=>{i({type:"USER_PARTNER_SETTING_CHANGE",payload:{id:e,field:t,value:n}})},p=e=>{let t=e.split(" ");return{first_name:t[0],last_name:t[1]}},m=({field:e,value:t,passcode:n,onSettingSavedHn:r,showErrorHn:l,surfaceTag:s,userId:c,passcodeSkipAcknowledged:d=!1})=>async(m,v)=>{let f=v().users[c],h={user_id:c,surface_tag:s};if("full_name"===e){if(f.is_partner)h.business_name=t;else{let e=p(t);h.first_name=e.first_name,h.last_name=e.last_name||""}}else h[e]=t;n&&(h.passcode=n),a.i.includes(e)&&null!=d&&(h.user_confirm_skip_passcode=d);try{if(await i.Z.create("UserSettingsResource",h).callUpdate(),"profile_image_url"===e)m((0,o.b)("UserResource",{options:h}));else if("full_name"===e){if(f.is_partner)m(u(c,"first_name",t));else{let e=p(t);m(u(c,"first_name",e.first_name)),m(u(c,"last_name",e.last_name))}}m(f.is_partner&&("account_type"===e||"contact_name"===e)?_(c,e,t):u(c,e,t)),r()}catch(e){l(e)}},v=(e,t,n,i,a,o,l)=>()=>{(0,r.Z)({new:t,new_confirm:n,old:e,passcode:i,recaptcha_v3_token:a}).then(o,l)},f=(e,t,n,a,r,o)=>l=>{l(u(e,`${t}.${n}`,a));let s={},c="EmailSettingsResource";void 0!==r?(s={section:t,option:n,value:a,od:r.od,user_id:r.user_id},c="UnsubEmailSettingsResource"):s={section:t,option:n,value:a},i.Z.create(c,s).callUpdate().then(o).catch(()=>l(u(e,`${t}.${n}`,!a)))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/app-common-react-components-closeup-CloseupBody-SaveAffordance-95327ee9e654f11e.mjs.map